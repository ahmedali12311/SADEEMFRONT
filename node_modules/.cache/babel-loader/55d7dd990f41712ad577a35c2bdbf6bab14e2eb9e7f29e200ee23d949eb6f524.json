{"ast":null,"code":"import React,{useEffect,useRef,useState,useCallback}from'react';import{Link,useNavigate}from'react-router-dom';import{jwtDecode}from'jwt-decode';// Fixed import\nimport'../css/Navbar.css';import logo from'../css/vendor.jpg';import defaultImage from'../css/vendor.jpg';import{useOrderUpdate}from'./OrderUpdateContext';// Import the context\nimport{jsx as _jsx,Fragment as _Fragment,jsxs as _jsxs}from\"react/jsx-runtime\";const Navbar=_ref=>{let{initialCartItems=[],onCartItemsChange,refreshCart}=_ref;// Default to empty array\nconst[userRole,setUserRole]=useState(null);const[isTransparent,setIsTransparent]=useState(false);const[cartDropdownVisible,setCartDropdownVisible]=useState(false);const[cartItems,setCartItems]=useState(initialCartItems);// Initial cart items or empty array\nconst[editedCartItems,setEditedCartItems]=useState([]);// Track the edited cart items here\nconst[cart,setCart]=useState({});const[cartDescription,setCartDescription]=useState('');const[initialCartDescription,setInitialCartDescription]=useState('');const[errorMessage,setErrorMessage]=useState(null);const[successMessage,setSuccessMessage]=useState(null);const[totalPrice,setTotalPrice]=useState(0);const[totalQuantity,setTotalQuantity]=useState(0);const[loadingCartItems,setLoadingCartItems]=useState(false);const[loadingDeleteItems,setLoadingDeleteItems]=useState({});const[loadingCheckout,setLoadingCheckout]=useState(false);const[isQuantitySaved,setIsQuantitySaved]=useState(true);// State to track if quantity and description are saved\nconst navigate=useNavigate();const dropdownRef=useRef(null);const{setShouldUpdateOrders}=useOrderUpdate();// Use the context\nconst[isSaving,setIsSaving]=useState(false);const[initialQuantities,setInitialQuantities]=useState([]);// Track initial quantities\nconst[initialPrices,setInitialPrices]=useState([]);// Fetch cart items and update state\nconst fetchCartItems=useCallback(async()=>{const token=localStorage.getItem('token');if(!token)return;try{var _cartData$cart,_cartData$cart2,_cartData$cart3;setLoadingCartItems(true);const[itemsResponse,cartResponse]=await Promise.all([fetch('https://backend-934694036821.europe-west1.run.app/cartitems',{headers:{Authorization:`Bearer ${token}`}}),fetch('https://backend-934694036821.europe-west1.run.app/carts',{headers:{Authorization:`Bearer ${token}`}})]);if(!itemsResponse.ok||!cartResponse.ok){throw new Error('You must have a table to checkout!');}const itemsData=await itemsResponse.json();console.log(itemsData.cart);setInitialQuantities(itemsData.cart.map(item=>item.quantity));// Store initial quantities\nsetInitialQuantities(itemsData.cart.map(item=>item.quantity));setInitialPrices(itemsData.cart.map(item=>item.price||0));// Track initial prices\nsetCartItems(itemsData.cart||[]);setEditedCartItems(itemsData.cart||[]);// Initialize editedCartItems with the current cart items\nconst cartData=await cartResponse.json();setCart(cartData);setCartDescription(((_cartData$cart=cartData.cart)===null||_cartData$cart===void 0?void 0:_cartData$cart.description)||'');setInitialCartDescription(((_cartData$cart2=cartData.cart)===null||_cartData$cart2===void 0?void 0:_cartData$cart2.description)||'');setTotalPrice(((_cartData$cart3=cartData.cart)===null||_cartData$cart3===void 0?void 0:_cartData$cart3.total_price)||0);updateTotalQuantityAndPrice(itemsData.cart);// Update total quantity and price based on items\nsetIsQuantitySaved(true);// Reset quantity saved state\n}catch(error){}finally{setLoadingCartItems(false);// Ensure loading state is reset even on error\n}},[]);// Empty dependency array since this function doesn't use external variables\nuseEffect(()=>{fetchCartItems();},[fetchCartItems,refreshCart]);// Add fetchCartItems to dependency array\nuseEffect(()=>{const token=localStorage.getItem('token');if(token){try{const decodedToken=jwtDecode(token);const currentTime=Date.now()/1000;if(decodedToken.exp<currentTime){localStorage.removeItem('token');setUserRole(null);}else{setUserRole(decodedToken.userRole);fetchCartItems();}}catch(error){console.error('Error decoding token:',error);localStorage.removeItem('token');setUserRole(null);}}},[fetchCartItems]);useEffect(()=>{const handleScroll=()=>{setIsTransparent(window.scrollY>50);};window.addEventListener('scroll',handleScroll);return()=>window.removeEventListener('scroll',handleScroll);},[]);useEffect(()=>{const handleClickOutside=event=>{if(dropdownRef.current&&!dropdownRef.current.contains(event.target)){setCartDropdownVisible(false);}};document.addEventListener('mousedown',handleClickOutside);return()=>document.removeEventListener('mousedown',handleClickOutside);},[]);const handleSignOut=()=>{localStorage.removeItem('token');setUserRole(null);navigate('/signin');};const toggleCartDropdown=()=>{setCartDropdownVisible(prev=>!prev);};const handleCartDescriptionChange=e=>{const value=e.target.value;if(value.length<=100){setCartDescription(value);setIsQuantitySaved(false);// Mark the state as unsaved since the description changed\nsetErrorMessage(null);// Clear error if it's within the limit\n}else{setErrorMessage('Description cannot exceed 100 characters.');}};const deleteCartItem=async itemId=>{setLoadingDeleteItems(prevState=>({...prevState,[itemId]:true}));try{const token=localStorage.getItem('token');const response=await fetch(`https://backend-934694036821.europe-west1.run.app/cartitems/${itemId}`,{method:'DELETE',headers:{'Content-Type':'application/x-www-form-urlencoded','Authorization':`Bearer ${token}`}});if(!response.ok){const errorData=await response.json();throw new Error(errorData.errors?JSON.stringify(errorData.errors):'Network response was not ok');}const updatedCartItems=cartItems.filter(item=>item.item_id!==itemId);setCartItems(updatedCartItems);setEditedCartItems(updatedCartItems);updateTotalQuantityAndPrice(updatedCartItems);console.log('Item deleted successfully');}catch(error){console.error('Error deleting cart item:',error);setErrorMessage('Error removing item. Please try again.');}finally{setLoadingDeleteItems(prevState=>({...prevState,[itemId]:false}));}};const updateCartItemQuantityLocally=(itemId,newQuantity)=>{if(newQuantity<1)return;const updatedItems=editedCartItems.map(item=>item.item_id===itemId?{...item,quantity:newQuantity}:item);setEditedCartItems(updatedItems);if(updatedItems.find(item=>item.item_id===itemId).quantity===cartItems.find(item=>item.item_id===itemId).quantity){setIsQuantitySaved(true);// Reset quantity saved state if the quantity is returned to its default value\n}else{setIsQuantitySaved(false);// Indicate that new changes are unsaved\n}updateTotalQuantityAndPrice(updatedItems);// Update the total quantity and price based on new items\n};const updateTotalQuantityAndPrice=items=>{const total=items.reduce((acc,item)=>acc+item.quantity,0);const price=items.reduce((acc,item)=>{const itemPrice=item.discount||item.price||0;// Ensure item.price is a valid number or default to 0\nreturn acc+item.quantity*parseFloat(itemPrice);// Ensure the price is parsed as a float\n},0);setTotalQuantity(total);setTotalPrice(price);};const saveCartChanges=async()=>{setLoadingCartItems(true);setIsSaving(true);try{const token=localStorage.getItem('token');// Update item quantities in the backend\nconst quantityPromises=editedCartItems.map(item=>fetch(`https://backend-934694036821.europe-west1.run.app/cartitems/${item.item_id}`,{method:'PUT',headers:{'Content-Type':'application/x-www-form-urlencoded','Authorization':`Bearer ${token}`},body:new URLSearchParams({item_id:item.item_id,quantity:item.quantity}).toString()}));// Update the cart description in the backend\nconst descriptionPromise=fetch(`https://backend-934694036821.europe-west1.run.app/carts/${cart.cart.id}`,{method:'PUT',headers:{'Content-Type':'application/x-www-form-urlencoded','Authorization':`Bearer ${token}`},body:new URLSearchParams({description:cartDescription}).toString()});// Wait for all promises to resolve\nconst responses=await Promise.all([...quantityPromises,descriptionPromise]);// Check for any errors in the responses\nfor(const response of responses){if(!response.ok){const errorData=await response.json();throw new Error(errorData.errors?JSON.stringify(errorData.errors):'Error while saving cart changes');}}// Fetch updated cart after saving\nawait fetchCartItems();setIsQuantitySaved(true);// Mark as saved\nsetSuccessMessage('Cart updated successfully!');// Show success message\nsetErrorMessage(null);// Clear any error messages\n// Set a timer to clear the success message after 30 seconds\nsetTimeout(()=>{setSuccessMessage(null);},30000);}catch(error){console.error('Error saving cart changes:',error);setErrorMessage(error.message||'An unknown error occurred');setSuccessMessage(null);// Clear success message if an error occurs\n}finally{setLoadingCartItems(false);// Ensure loading state is reset even on error\nsetIsSaving(false);}};const handleCheckout=async()=>{if(!isQuantitySaved){setErrorMessage('Please save your changes before checking out.');return;}setLoadingCheckout(true);try{const token=localStorage.getItem('token');const response=await fetch('https://backend-934694036821.europe-west1.run.app/checkout',{method:'POST',headers:{'Authorization':`Bearer ${token}`}});if(!response.ok){const errorData=await response.json();throw new Error(errorData.errors?JSON.stringify(errorData.errors):'Network response was not ok');}console.log('Checkout successful');setCartItems([]);setShouldUpdateOrders(true);// Notify context that orders need to be updated\nwindow.location.reload();// Refresh the page\n}catch(error){console.error('Error during checkout:',error);setErrorMessage(error.message);setSuccessMessage(null);// Clear success message if an error occurs\n}finally{setLoadingCheckout(false);// Ensure loading state is reset even on error\n}};const handleDiscardChanges=()=>{// Reset edited quantities to their initial values\nconst resetItems=editedCartItems.map((item,index)=>({...item,quantity:initialQuantities[index]// Reset to initial quantity\n}));setTotalPrice(initialPrices.reduce((acc,price)=>acc+price,0));// Reset total price\nsetTotalQuantity(initialQuantities.reduce((acc,qty)=>acc+qty,0));// Reset total quantity\nsetEditedCartItems(resetItems);setCartDescription(initialCartDescription);// Reset description to initial value\nsetIsQuantitySaved(true);// Mark as saved since we have discarded changes\nsetErrorMessage(null);// Clear any error messages\nsetSuccessMessage('Changes discarded.');};return/*#__PURE__*/_jsxs(\"nav\",{className:`navbar ${isTransparent?'transparent':''}`,children:[/*#__PURE__*/_jsx(\"div\",{className:\"logo\",children:/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"Logo\"})}),/*#__PURE__*/_jsx(\"ul\",{className:\"center-links\",children:/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/\",children:\"Home\"})})}),/*#__PURE__*/_jsxs(\"ul\",{className:\"end-links\",children:[userRole===\"1\"&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/add-vendor\",children:\"Add Vendor\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/users\",children:\"Users\"})})]}),userRole?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/profile\",children:\"Profile\"})}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/orders\",children:\"Orders\"})}),/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"button\",{onClick:toggleCartDropdown,disabled:loadingCartItems,children:loadingCartItems?'Loading ...':'Cart'}),cartDropdownVisible&&/*#__PURE__*/_jsxs(\"div\",{className:\"cart-dropdown\",ref:dropdownRef,children:[loadingCartItems?/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}):cartItems.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No items in cart\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"ul\",{className:\"cart-list\",children:editedCartItems.map(item=>/*#__PURE__*/_jsxs(\"li\",{className:\"cart-item\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"cart-item-img\",children:/*#__PURE__*/_jsx(\"img\",{src:item.img||defaultImage,alt:item.name,onError:e=>e.target.src=defaultImage})}),/*#__PURE__*/_jsx(\"div\",{className:\"cart-item-name\",children:item.name}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-item-quantity\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateCartItemQuantityLocally(item.item_id,item.quantity-1),children:\"-\"}),/*#__PURE__*/_jsx(\"span\",{children:item.quantity}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>updateCartItemQuantityLocally(item.item_id,item.quantity+1),children:\"+\"})]}),/*#__PURE__*/_jsx(\"button\",{onClick:()=>deleteCartItem(item.item_id),className:\"removebutton\",children:\"Remove\"}),loadingDeleteItems[item.item_id]&&/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"})]},item.item_id))}),/*#__PURE__*/_jsxs(\"div\",{className:\"cart-summary\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Total Quantity: \",totalQuantity]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Total Price: $\",totalPrice.toFixed(2)]})]})]}),cartItems.length!==0&&/*#__PURE__*/_jsxs(\"div\",{className:\"cart-description\",children:[/*#__PURE__*/_jsx(\"textarea\",{value:cartDescription,onChange:handleCartDescriptionChange,placeholder:\"Write a note for your order...\",rows:\"3\",maxLength:\"100\"}),/*#__PURE__*/_jsxs(\"p\",{children:[cartDescription.length,\"/100\"]}),\" \"]}),!loadingCheckout&&totalQuantity>0&&!isQuantitySaved&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"button\",{onClick:saveCartChanges,disabled:isSaving,children:isSaving?'Saving...':'Save'}),/*#__PURE__*/_jsx(\"button\",{onClick:handleDiscardChanges,children:\"Discard Changes\"})]}),isQuantitySaved&&/*#__PURE__*/_jsx(\"button\",{onClick:handleCheckout,disabled:loadingCheckout,children:loadingCheckout?'Processing Checkout...':'Checkout'}),successMessage&&/*#__PURE__*/_jsx(\"p\",{style:{color:'green'},children:successMessage}),errorMessage&&/*#__PURE__*/_jsx(\"p\",{style:{color:'red'},children:errorMessage})]})]}),/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(\"button\",{onClick:handleSignOut,children:\"Sign Out\"})})]}):/*#__PURE__*/_jsx(\"li\",{children:/*#__PURE__*/_jsx(Link,{to:\"/signin\",children:\"Sign In\"})})]})]});};export default Navbar;","map":{"version":3,"names":["React","useEffect","useRef","useState","useCallback","Link","useNavigate","jwtDecode","logo","defaultImage","useOrderUpdate","jsx","_jsx","Fragment","_Fragment","jsxs","_jsxs","Navbar","_ref","initialCartItems","onCartItemsChange","refreshCart","userRole","setUserRole","isTransparent","setIsTransparent","cartDropdownVisible","setCartDropdownVisible","cartItems","setCartItems","editedCartItems","setEditedCartItems","cart","setCart","cartDescription","setCartDescription","initialCartDescription","setInitialCartDescription","errorMessage","setErrorMessage","successMessage","setSuccessMessage","totalPrice","setTotalPrice","totalQuantity","setTotalQuantity","loadingCartItems","setLoadingCartItems","loadingDeleteItems","setLoadingDeleteItems","loadingCheckout","setLoadingCheckout","isQuantitySaved","setIsQuantitySaved","navigate","dropdownRef","setShouldUpdateOrders","isSaving","setIsSaving","initialQuantities","setInitialQuantities","initialPrices","setInitialPrices","fetchCartItems","token","localStorage","getItem","_cartData$cart","_cartData$cart2","_cartData$cart3","itemsResponse","cartResponse","Promise","all","fetch","headers","Authorization","ok","Error","itemsData","json","console","log","map","item","quantity","price","cartData","description","total_price","updateTotalQuantityAndPrice","error","decodedToken","currentTime","Date","now","exp","removeItem","handleScroll","window","scrollY","addEventListener","removeEventListener","handleClickOutside","event","current","contains","target","document","handleSignOut","toggleCartDropdown","prev","handleCartDescriptionChange","e","value","length","deleteCartItem","itemId","prevState","response","method","errorData","errors","JSON","stringify","updatedCartItems","filter","item_id","updateCartItemQuantityLocally","newQuantity","updatedItems","find","items","total","reduce","acc","itemPrice","discount","parseFloat","saveCartChanges","quantityPromises","body","URLSearchParams","toString","descriptionPromise","id","responses","setTimeout","message","handleCheckout","location","reload","handleDiscardChanges","resetItems","index","qty","className","children","src","alt","to","onClick","disabled","ref","img","name","onError","toFixed","onChange","placeholder","rows","maxLength","style","color"],"sources":["C:/Users/oG_Ju/OneDrive/Desktop/SadeemVendorapp/frontend/src/components/navbar.js"],"sourcesContent":["import React, { useEffect, useRef, useState, useCallback } from 'react';\r\nimport { Link, useNavigate } from 'react-router-dom';\r\nimport { jwtDecode } from 'jwt-decode'; // Fixed import\r\nimport '../css/Navbar.css';\r\nimport logo from '../css/vendor.jpg';\r\nimport defaultImage from '../css/vendor.jpg';\r\nimport { useOrderUpdate } from './OrderUpdateContext'; // Import the context\r\n\r\nconst Navbar = ({ initialCartItems = [], onCartItemsChange, refreshCart }) => { // Default to empty array\r\n    const [userRole, setUserRole] = useState(null);\r\n    const [isTransparent, setIsTransparent] = useState(false);\r\n    const [cartDropdownVisible, setCartDropdownVisible] = useState(false);\r\n    const [cartItems, setCartItems] = useState(initialCartItems); // Initial cart items or empty array\r\n    const [editedCartItems, setEditedCartItems] = useState([]); // Track the edited cart items here\r\n    const [cart, setCart] = useState({});\r\n    const [cartDescription, setCartDescription] = useState('');\r\n    const [initialCartDescription, setInitialCartDescription] = useState('');\r\n    const [errorMessage, setErrorMessage] = useState(null);\r\n    const [successMessage, setSuccessMessage] = useState(null);\r\n    const [totalPrice, setTotalPrice] = useState(0);\r\n    const [totalQuantity, setTotalQuantity] = useState(0);\r\n    const [loadingCartItems, setLoadingCartItems] = useState(false);\r\n    const [loadingDeleteItems, setLoadingDeleteItems] = useState({});\r\n\r\n    const [loadingCheckout, setLoadingCheckout] = useState(false);\r\n    const [isQuantitySaved, setIsQuantitySaved] = useState(true); // State to track if quantity and description are saved\r\n    const navigate = useNavigate();\r\n    const dropdownRef = useRef(null);\r\n    const { setShouldUpdateOrders } = useOrderUpdate(); // Use the context\r\n    const [isSaving, setIsSaving] = useState(false);\r\n    const [initialQuantities, setInitialQuantities] = useState([]); // Track initial quantities\r\n    const [initialPrices, setInitialPrices] = useState([]);\r\n    // Fetch cart items and update state\r\n    const fetchCartItems = useCallback(async () => {\r\n        const token = localStorage.getItem('token');\r\n        if (!token) return;\r\n\r\n        try {\r\n            setLoadingCartItems(true);\r\n            const [itemsResponse, cartResponse] = await Promise.all([\r\n                fetch('https://backend-934694036821.europe-west1.run.app/cartitems', {\r\n                    headers: { Authorization: `Bearer ${token}` }\r\n                }),\r\n                fetch('https://backend-934694036821.europe-west1.run.app/carts', {\r\n                    headers: { Authorization: `Bearer ${token}` }\r\n                })\r\n            ]);\r\n\r\n            if (!itemsResponse.ok || !cartResponse.ok) {\r\n                throw new Error('You must have a table to checkout!');\r\n            }\r\n\r\n            const itemsData = await itemsResponse.json();\r\n            console.log(itemsData.cart)\r\n\r\n            setInitialQuantities(itemsData.cart.map(item => item.quantity)); // Store initial quantities\r\n            setInitialQuantities(itemsData.cart.map(item => item.quantity));\r\n            setInitialPrices(itemsData.cart.map(item => item.price || 0)); // Track initial prices\r\n            setCartItems(itemsData.cart || []);\r\n            setEditedCartItems(itemsData.cart || []); // Initialize editedCartItems with the current cart items\r\n            const cartData = await cartResponse.json();\r\n            setCart(cartData);\r\n            setCartDescription(cartData.cart?.description || '');\r\n            setInitialCartDescription(cartData.cart?.description || '');\r\n          \r\n            setTotalPrice(cartData.cart?.total_price || 0);\r\n            updateTotalQuantityAndPrice(itemsData.cart); // Update total quantity and price based on items\r\n            setIsQuantitySaved(true); // Reset quantity saved state\r\n        } catch (error) {\r\n        } finally {\r\n            setLoadingCartItems(false); // Ensure loading state is reset even on error\r\n        }\r\n    }, []); // Empty dependency array since this function doesn't use external variables\r\n\r\n    useEffect(() => {\r\n        fetchCartItems();\r\n    }, [fetchCartItems, refreshCart]); // Add fetchCartItems to dependency array\r\n\r\n    useEffect(() => {\r\n        const token = localStorage.getItem('token');\r\n        if (token) {\r\n            try {\r\n                const decodedToken = jwtDecode(token);\r\n                const currentTime = Date.now() / 1000;\r\n                if (decodedToken.exp < currentTime) {\r\n                    localStorage.removeItem('token');\r\n                    setUserRole(null);\r\n                } else {\r\n                    setUserRole(decodedToken.userRole);\r\n                    fetchCartItems();\r\n                }\r\n            } catch (error) {\r\n                console.error('Error decoding token:', error);\r\n                localStorage.removeItem('token');\r\n                setUserRole(null);\r\n            }\r\n        }\r\n    }, [fetchCartItems]);\r\n\r\n    useEffect(() => {\r\n        const handleScroll = () => {\r\n            setIsTransparent(window.scrollY > 50);\r\n        };\r\n\r\n        window.addEventListener('scroll', handleScroll);\r\n        return () => window.removeEventListener('scroll', handleScroll);\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        const handleClickOutside = (event) => {\r\n            if (dropdownRef.current && !dropdownRef.current.contains(event.target)) {\r\n                setCartDropdownVisible(false);\r\n            }\r\n        };\r\n\r\n        document.addEventListener('mousedown', handleClickOutside);\r\n        return () => document.removeEventListener('mousedown', handleClickOutside);\r\n    }, []);\r\n\r\n    const handleSignOut = () => {\r\n        localStorage.removeItem('token');\r\n        setUserRole(null);\r\n        navigate('/signin');\r\n    };\r\n\r\n    const toggleCartDropdown = () => {\r\n        setCartDropdownVisible(prev => !prev);\r\n    };\r\n\r\n    const handleCartDescriptionChange = (e) => {\r\n        const value = e.target.value;\r\n        if (value.length <= 100) {\r\n            setCartDescription(value);\r\n            setIsQuantitySaved(false); // Mark the state as unsaved since the description changed\r\n            setErrorMessage(null); // Clear error if it's within the limit\r\n        } else {\r\n            setErrorMessage('Description cannot exceed 100 characters.');\r\n        }\r\n    };\r\n\r\n    const deleteCartItem = async (itemId) => {\r\n        setLoadingDeleteItems(prevState => ({ ...prevState, [itemId]: true }));\r\n        try {\r\n            const token = localStorage.getItem('token');\r\n            const response = await fetch(`https://backend-934694036821.europe-west1.run.app/cartitems/${itemId}`, {\r\n                method: 'DELETE',\r\n                headers: {\r\n                    'Content-Type': 'application/x-www-form-urlencoded',\r\n                    'Authorization': `Bearer ${token}`\r\n                }\r\n            });\r\n    \r\n            if (!response.ok) {\r\n                const errorData = await response.json();\r\n                throw new Error(errorData.errors ? JSON.stringify(errorData.errors) : 'Network response was not ok');\r\n            }\r\n            const updatedCartItems = cartItems.filter(item => item.item_id !== itemId);\r\n            setCartItems(updatedCartItems);\r\n            setEditedCartItems(updatedCartItems);\r\n            updateTotalQuantityAndPrice(updatedCartItems);\r\n\r\n            console.log('Item deleted successfully');\r\n        } catch (error) {\r\n            console.error('Error deleting cart item:', error);\r\n            setErrorMessage('Error removing item. Please try again.');\r\n        } finally {\r\n            setLoadingDeleteItems(prevState => ({ ...prevState, [itemId]: false }));\r\n        }\r\n    };\r\n    \r\n\r\n    const updateCartItemQuantityLocally = (itemId, newQuantity) => {\r\n        if (newQuantity < 1) return;\r\n\r\n        const updatedItems = editedCartItems.map(item =>\r\n            item.item_id === itemId ? { ...item, quantity: newQuantity } : item\r\n        );\r\n        setEditedCartItems(updatedItems);\r\n        if (updatedItems.find(item => item.item_id === itemId).quantity === cartItems.find(item => item.item_id === itemId).quantity) {\r\n            setIsQuantitySaved(true); // Reset quantity saved state if the quantity is returned to its default value\r\n        } else {\r\n            setIsQuantitySaved(false); // Indicate that new changes are unsaved\r\n        }\r\n        updateTotalQuantityAndPrice(updatedItems); // Update the total quantity and price based on new items\r\n    };\r\n\r\n    const updateTotalQuantityAndPrice = (items) => {\r\n        const total = items.reduce((acc, item) => acc + item.quantity, 0);\r\n        const price = items.reduce((acc, item) => {\r\n            const itemPrice =item.discount|| item.price || 0; // Ensure item.price is a valid number or default to 0\r\n            return acc + item.quantity * parseFloat(itemPrice); // Ensure the price is parsed as a float\r\n        }, 0);\r\n        \r\n        setTotalQuantity(total);\r\n        setTotalPrice(price);\r\n    };\r\n    \r\n    const saveCartChanges = async () => {\r\n        setLoadingCartItems(true);\r\n        setIsSaving(true);\r\n        try {\r\n            const token = localStorage.getItem('token');\r\n\r\n            // Update item quantities in the backend\r\n            const quantityPromises = editedCartItems.map(item =>\r\n                fetch(`https://backend-934694036821.europe-west1.run.app/cartitems/${item.item_id}`, {\r\n                    method: 'PUT',\r\n                    headers: {\r\n                        'Content-Type': 'application/x-www-form-urlencoded',\r\n                        'Authorization': `Bearer ${token}`\r\n                    },\r\n                    body: new URLSearchParams({\r\n                        item_id: item.item_id,\r\n                        quantity: item.quantity\r\n                    }).toString()\r\n                })\r\n            );\r\n            // Update the cart description in the backend\r\n            const descriptionPromise = fetch(`https://backend-934694036821.europe-west1.run.app/carts/${cart.cart.id}`, {\r\n                method: 'PUT',\r\n                headers: {\r\n                    'Content-Type': 'application/x-www-form-urlencoded',\r\n                    'Authorization': `Bearer ${token}`\r\n                },\r\n                body: new URLSearchParams({\r\n                    description: cartDescription\r\n                }).toString()\r\n            });\r\n\r\n            // Wait for all promises to resolve\r\n            const responses = await Promise.all([...quantityPromises, descriptionPromise]);\r\n\r\n            // Check for any errors in the responses\r\n            for (const response of responses) {\r\n                if (!response.ok) {\r\n                    const errorData = await response.json();\r\n                    throw new Error(errorData.errors ? JSON.stringify(errorData.errors) : 'Error while saving cart changes');\r\n                }\r\n            }\r\n\r\n            // Fetch updated cart after saving\r\n            await fetchCartItems();\r\n\r\n            setIsQuantitySaved(true); // Mark as saved\r\n            setSuccessMessage('Cart updated successfully!'); // Show success message\r\n            setErrorMessage(null); // Clear any error messages\r\n\r\n            // Set a timer to clear the success message after 30 seconds\r\n            setTimeout(() => {\r\n                setSuccessMessage(null);\r\n            }, 30000);\r\n        } catch (error) {\r\n            console.error('Error saving cart changes:', error);\r\n            setErrorMessage(error.message || 'An unknown error occurred');\r\n            setSuccessMessage(null); // Clear success message if an error occurs\r\n        } finally {\r\n            setLoadingCartItems(false); // Ensure loading state is reset even on error\r\n            setIsSaving(false);\r\n        }\r\n    };\r\n\r\n    const handleCheckout = async () => {\r\n        if (!isQuantitySaved) {\r\n            setErrorMessage('Please save your changes before checking out.');\r\n            return;\r\n        }\r\n\r\n        setLoadingCheckout(true);\r\n        try {\r\n            const token = localStorage.getItem('token');\r\n            const response = await fetch('https://backend-934694036821.europe-west1.run.app/checkout', {\r\n                method: 'POST',\r\n                headers: { 'Authorization': `Bearer ${token}` }\r\n            });\r\n\r\n            if (!response.ok) {\r\n                const errorData = await response.json();\r\n                throw new Error(errorData.errors ? JSON.stringify(errorData.errors) : 'Network response was not ok');\r\n            }\r\n\r\n            console.log('Checkout successful');\r\n            setCartItems([]);\r\n            setShouldUpdateOrders(true); // Notify context that orders need to be updated\r\n            window.location.reload(); // Refresh the page\r\n        } catch (error) {\r\n            console.error('Error during checkout:', error);\r\n            setErrorMessage(error.message);\r\n            setSuccessMessage(null); // Clear success message if an error occurs\r\n        } finally {\r\n            setLoadingCheckout(false); // Ensure loading state is reset even on error\r\n        }\r\n    };\r\n\r\n    const handleDiscardChanges = () => {\r\n        // Reset edited quantities to their initial values\r\n        const resetItems = editedCartItems.map((item, index) => ({\r\n            ...item,\r\n            quantity: initialQuantities[index] // Reset to initial quantity\r\n        }));\r\n        setTotalPrice(initialPrices.reduce((acc, price) => acc + price, 0)); // Reset total price\r\n        setTotalQuantity(initialQuantities.reduce((acc, qty) => acc + qty, 0)); // Reset total quantity\r\n        setEditedCartItems(resetItems);\r\n        setCartDescription(initialCartDescription); // Reset description to initial value\r\n        setIsQuantitySaved(true); // Mark as saved since we have discarded changes\r\n        setErrorMessage(null); // Clear any error messages\r\n        setSuccessMessage('Changes discarded.');\r\n    };\r\n    return (\r\n        <nav className={`navbar ${isTransparent ? 'transparent' : ''}`}>\r\n            <div className=\"logo\">\r\n                <img src={logo} alt=\"Logo\" />\r\n            </div>\r\n            <ul className=\"center-links\">\r\n                <li><Link to=\"/\">Home</Link></li>\r\n            </ul>\r\n            <ul className=\"end-links\">\r\n                {userRole === \"1\" && (\r\n                    <>\r\n                        <li><Link to=\"/add-vendor\">Add Vendor</Link></li>\r\n                        <li><Link to=\"/users\">Users</Link></li>\r\n                    </>\r\n                )}\r\n                {userRole ? (\r\n                    <>\r\n                        <li><Link to=\"/profile\">Profile</Link></li>\r\n                        <li><Link to=\"/orders\">Orders</Link></li>\r\n                        <li>\r\n                            <button onClick={toggleCartDropdown} disabled={loadingCartItems}>\r\n                                {loadingCartItems ? 'Loading ...': 'Cart'}\r\n                            </button>\r\n                            {cartDropdownVisible && (\r\n                                <div className=\"cart-dropdown\" ref={dropdownRef}>\r\n                                    {loadingCartItems ? (\r\n                                        <div className=\"spinner\"></div> \r\n                                                                        ) : cartItems.length === 0 ? (\r\n                                        <p>No items in cart</p>\r\n                                    ) : (\r\n                                        <>\r\n                                            <ul className=\"cart-list\">\r\n                                                {editedCartItems.map(item => (\r\n                                                    <li key={item.item_id} className=\"cart-item\">\r\n                                                        <div className=\"cart-item-img\">\r\n                                                            <img src={item.img || defaultImage} alt={item.name}\r\n                                                                onError={(e) => e.target.src = defaultImage} />\r\n                                                        </div>\r\n                                                        <div className=\"cart-item-name\">{item.name}</div>\r\n                                                        <div className=\"cart-item-quantity\">\r\n                                                            <button onClick={() => updateCartItemQuantityLocally(item.item_id, item.quantity - 1)}>-</button>\r\n                                                            <span>{item.quantity}</span>\r\n                                                            <button onClick={() => updateCartItemQuantityLocally(item.item_id, item.quantity + 1)}>+</button>\r\n                                                        </div>\r\n                                                        <button onClick={() => deleteCartItem(item.item_id)} className='removebutton'>Remove</button>\r\n                                                        {loadingDeleteItems[item.item_id] && (\r\n            <div className=\"spinner\"></div>\r\n        )}\r\n                                                    </li>\r\n                                                ))}\r\n                                            </ul>\r\n                                            <div className=\"cart-summary\">\r\n                                                <p>Total Quantity: {totalQuantity}</p>\r\n                                                <p>Total Price: ${totalPrice.toFixed(2)}</p>\r\n                                            </div>\r\n                                        </>\r\n                                    )}\r\n\r\n{cartItems.length !== 0 && (\r\n    <div className=\"cart-description\">\r\n        <textarea\r\n            value={cartDescription}\r\n            onChange={handleCartDescriptionChange}\r\n            placeholder=\"Write a note for your order...\"\r\n            rows=\"3\"\r\n            maxLength=\"100\"\r\n        />\r\n        <p>{cartDescription.length}/100</p> {/* Character count */}\r\n    </div>\r\n)}\r\n  {!loadingCheckout && totalQuantity > 0 && !isQuantitySaved && (\r\n    <>\r\n        <button onClick={saveCartChanges} disabled={isSaving}>\r\n            {isSaving ? 'Saving...' : 'Save'}\r\n        </button>\r\n        <button onClick={handleDiscardChanges}>\r\n            Discard Changes\r\n        </button>\r\n    </>\r\n)}\r\n\r\n{isQuantitySaved && (\r\n    <button onClick={handleCheckout} disabled={loadingCheckout}>\r\n        {loadingCheckout ? 'Processing Checkout...' : 'Checkout'}\r\n    </button>\r\n)}\r\n                                    {successMessage && (\r\n                                        <p style={{ color: 'green' }}>{successMessage}</p>\r\n                                    )}\r\n                                    {errorMessage && (\r\n                                        <p style={{ color: 'red' }}>{errorMessage}</p>\r\n                                    )}\r\n                                </div>\r\n                            )}\r\n                        </li>\r\n                        <li><button onClick={handleSignOut}>Sign Out</button></li>\r\n                    </>\r\n                ) : (\r\n                    <li><Link to=\"/signin\">Sign In</Link></li>\r\n                )}\r\n            </ul>\r\n        </nav>\r\n    );\r\n};\r\n\r\nexport default Navbar;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}